# 上传流程

> 上传大小为 1024*1024 也就是1MB

对于所有的返回 ,若`is_success`为`false`其他信息全部视为无用

## 上传开始



- 前端只传图片整体SHA256与头部4k,尾部4k的SHA256散列值与大体上传信息

- >格式如下:
  >
  >start_time: 2024-06-01 00:00:00
  >end_time: 2024-12-31 23:59:59
  >uploader: test_user
  >image_name: example_image
  >
  >image_type:png
  >
  >image_hash: 1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
  >image_size: 20971520
  >image_width: 1920
  >image_height: 1080
  >chunk_num: 10

- 前端需要计算整个图片SHA,与图片前4k与后4k的SHA填入传入后端,

  开始时间取当前中国北京时间,结束时间以此类推1小时

- 后端数据库查询,

- 查询有:直接返回url与上传完成标识: is_hit,is_success为true

- 查询无:返回上传的临时`is_image_upload_access_token`,`is_hit`为false,   于此同时创建临时的文件夹与上传信息文件

## 上传

 前端根据预先定好的分片大小进行携带`image_access_token`分片传输,后端会根据临时文件夹进行存储,只返回成功与否

## 上传完成

前端携带`image_access_token` 并表示上传结束,后端根据`image_access_token`进行图片合成,完成后具体数据存入数据库并返回访问url